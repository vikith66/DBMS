SQL>  select job,sum(sal) from emp1 group by job;

JOB         SUM(SAL)
--------- ----------
CEO            60000
GM             45000
A_MGR         117000
CLRK          205000
MGR           129000

SQL>  with max_emp As(select dname,count(empno) as EMP_COUNT from emp1 e join dept d on e.deptno=d.dno where e.prj_id='P
1' group by dname) select dname
  2  ,emp_count from max_emp where emp_count=(select max(emp_count) from max_emp);

DNAME            EMP_COUNT
--------------- ----------
Operations               7

SQL> select ename,job from emp1 join dept1 on deptno=dno where dname in('Marketing','Reasearch');

ENAME      JOB
---------- ---------
Ravi       MGR
Raviraj    CLRK
Raju       A_MGR
Devendra   A_MGR
Raju       CLRK
Malhan     CLRK
Ravirj     A_MGR
Kavirj     MGR
Kirti      CLRK
Keneth     CLRK

10 rows selected.

SQL> select ename,sal from emp1 where sal>(select min(sal) from emp);

no rows selected

SQL> select ename,sal from emp1 where sal>(select min(sal) from emp1);

ENAME             SAL
---------- ----------
Ravi            32000
Raviraj         24000
Raghu           45000
Ramu            60000
Raju            21000
Devendra        26000
Manu            23000
Raju            21000
Manoj           23000
Manohar         33000
Mahesh          35000

ENAME             SAL
---------- ----------
Mayank          25000
Malhan          25000
Ravirj          26000
Kavirj          29000
Maanya          21000
Mani            25000
Manikant        21000

18 rows selected.

SQL> with most_proj as(select prj_id,count(empno) as COUNTEMP from emp1 group by prj_id)
  2  select deptno
  3  from dept_avg
  4  where avgsal=(select max(avgsal) from dept_avg);
from dept_avg
     *
ERROR at line 3:
ORA-00942: table or view does not exist


SQL> with most_proj as(select prj_id,count(empno) as COUNTEMP
  2  from emp1
  3  group by prj_id)
  4  select ename
  5  from emp1
  6  where prj_id=(select prj_id from most_proj where countemp=(select max(countemp) from most_proj));

ENAME
----------
Ravi
Raju
Devendra
Manoj
Manohar
Ravirj
Kavirj
Kirti
Keneth
Maanya
Mani

ENAME
----------
Manikant

12 rows selected.

SQL> with dept_avg as(select deptno,avg(sal) as AVGSAL
  2  from emp1
  3  group by deptno)
  4  select deptno from dept_avg where avgsal=(select max(avgsal) from dept_avg);

DEP
---


SQL> Update Emp1 Set deptno='D2' Where empno In(150,111);

2 rows updated.

SQL> with dept_avg as(select deptno,avg(sal) as AVGSAL
  2  from emp1
  3  group by deptno)
  4  select deptno from dept_avg where avgsal=(select max(avgsal) from dept_avg);

DEP
---
D2

SQL> select dname,count(prj_no) as PROJECT_COUNT
  2  from dept1
  3  join proj on dept1.dno=proj.dno
  4  group by dname having count(prj_no)>1;

DNAME      PROJECT_COUNT
---------- -------------
Accounts               2
Marketing              3
HR                     2
Research               3

SQL> select count(empno) from emp1 where extract(day from date_join)>15;

COUNT(EMPNO)
------------
           0

SQL> select count(empno) from emp1 where to_char('dd','Date_Join')>15;
select count(empno) from emp1 where to_char('dd','Date_Join')>15
                                            *
ERROR at line 1:
ORA-01722: invalid number


SQL> select count(empno) from emp1 where to_char('dd','Date_Join')>'15';
select count(empno) from emp1 where to_char('dd','Date_Join')>'15'
                                            *
ERROR at line 1:
ORA-01722: invalid number


SQL> select count(empno) from emp1 where to_char(Date_Join,'dd')>'15';

COUNT(EMPNO)
------------
           0

SQL> select empno,ename,job from emp1 where job=(select job from emp1 where ename='Mahesh');

     EMPNO ENAME      JOB
---------- ---------- ---------
       142 Kavirj     MGR
       123 Mahesh     MGR
       106 Manohar    MGR
       101 Ravi       MGR

SQL> create view EMP_PRJ_VW as
  2  select e.empno,e.ename,e.job,e.mgrid,e.date_birth,e.sal,e.comm,e.deptno,e.prj_id,e.date_join,p.prj_name
  3  from emp1 e
  4  join dept1 d on e.deptno=d.dno
  5  join proj p on e.deptno=p.dno and e.prj_id=p.prj_no
  6  where dname='Marketing';
create view EMP_PRJ_VW as
            *
ERROR at line 1:
ORA-00955: name is already used by an existing object


SQL> drop view emp_prj_vw;

View dropped.

SQL> create view EMP_PRJ_VW as
  2  select e.empno,e.ename,e.job,e.mgrid,e.date_birth,e.sal,e.comm,e.deptno,e.prj_id,e.date_join,p.prj_name
  3  from emp1 e
  4  join dept1 d on e.deptno=d.dno
  5  join proj p on e.deptno=p.dno and e.prj_id=p.prj_no
  6  where dname='Marketing';

View created.

SQL> select ename,prj_name from EMP_PRJ_VW;

ENAME      PRJ_NAME
---------- --------------------------------------------------
Ravi       Mobile
Raju       Mobile
Devendra   Mobile
Ravirj     Mobile
Kavirj     Mobile
Kirti      Mobile
Keneth     Mobile
Raviraj    Drug Repositioning
Raju       Drug Repositioning
Malhan     Drug Repositioning

10 rows selected.

SQL> with dur as(select prj_id,e_date-s_date as Duration from task)
  2  select prj_id,sum(Duration) TOTAL_DAYS,avg(Duration) AVERAGE_DAYS
  3  from dur
  4  group by prj_id;

PRJ_I TOTAL_DAYS AVERAGE_DAYS
----- ---------- ------------
P1          1120          280
P2            67           67
P3           264          132
P4             8            4

SQL> select count(empno) NUMBER_OF_EMPLOYEES,extract(month from date_join) MONTH
  2  from emp1
  3  group by extract(month from date_join) order by MONTH;

NUMBER_OF_EMPLOYEES      MONTH
------------------- ----------
                  9         10
                  1         11
                 10         12

SQL> create index INDEX_ENAME_JOB on emp(ename,job);
create index INDEX_ENAME_JOB on emp(ename,job)
                                          *
ERROR at line 1:
ORA-00904: "JOB": invalid identifier


SQL> create index INDEX_ENAME_JOB on emp1(ename,job);
create index INDEX_ENAME_JOB on emp1(ename,job)
                                     *
ERROR at line 1:
ORA-01408: such column list already indexed


SQL> drop index INDEX_ENAME_JOB
  2  ;
drop index INDEX_ENAME_JOB
           *
ERROR at line 1:
ORA-01418: specified index does not exist


SQL> create index INDEX_ENAME_JOB on emp1(ename,job);
create index INDEX_ENAME_JOB on emp1(ename,job)
                                     *
ERROR at line 1:
ORA-01408: such column list already indexed
