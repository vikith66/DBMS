SET SERVEROUTPUT ON;
CREATE OR REPLACE PROCEDURE P_EMP(V_DNAME IN VARCHAR2)IS 
CURSOR CUR_EMP IS 
SELECT PRJ_NAME,ENAME 
FROM PROJ P,DEPT D, EMP E
WHERE D.DNAME=V_DNAME AND D.DNO=P.DNO AND E.DEPTNO=D.DNO AND P.PRJ_NO=E.PRJ_ID
GROUP BY PRJ_NAME,ENAME;

BEGIN 
 FOR I IN CUR_EMP
LOOP
  DBMS_OUTPUT.PUT_LINE(I.PRJ_NAME||' '||I.ENAME);
END LOOP;
END;
/ 

P3.
SET SERVEROUTPUT ON;
CREATE OR REPLACE FUNCTION PROJ_STATUS(P_PROJECT_ID IN VARCHAR2)
RETURN VARCHAR2 IS
V_PROJ_STATUS VARCHAR2(20);
V_CMPL_COUNT NUMBER;
V_IN_PRGRS_COUNT NUMBER;
V_NOT_STRTD_COUNT NUMBER;

BEGIN
  SELECT COUNT(*)
INTO V_CMPL_COUNT
FROM TASK
WHERE PRJ_ID=P_PROJECT_ID AND STATUS='COMPLETED';

SELECT COUNT(*)
INTO V_IN_PRGRS_COUNT
FROM TASK
WHERE PRJ_ID=P_PROJECT_ID AND STATUS='IN PROGRESS';

SELECT COUNT(*)
INTO V_NOT_STRTD_COUNT
FROM TASK
WHERE PRJ_ID=P_PROJECT_ID AND STATUS='NOT STARTED';


   IF V_CMPL_COUNT > 0 AND V_IN_PRGRS_COUNT = 0 AND V_NOT_STRTD_COUNT= 0 THEN
        V_PROJ_STATUS := 'COMPLETED';
    ELSIF V_IN_PRGRS_COUNT > 0 THEN
        V_PROJ_STATUS := 'IN PROGRESS';
    ELSIF V_NOT_STRTD_COUNT > 0 AND V_IN_PRGRS_COUNT = 0 AND V_CMPL_COUNT = 0 THEN
        V_PROJ_STATUS := 'NOT STARTED';
    ELSE
        V_PROJ_STATUS := 'Unknown Status';
    END IF;
    
    RETURN V_PROJ_STATUS;
END;
/


SET SERVEROUTPUT ON;
DECLARE
    v_status VARCHAR2(20);
BEGIN
    v_status := PROJ_STATUS('P1');
    DBMS_OUTPUT.PUT_LINE('Project Status: ' || v_status);
END;
/

P4.
SET SERVEROUTPUT ON;
CREATE OR REPLACE FUNCTION TOTAL_PROJECT_FUND (V_DEPTNO IN VARCHAR2)
RETURN NUMBER IS
CURSOR EMP_PRJ IS
 SELECT SUM (DEPT_BUDGET)AS TOTAL 
 FROM DEPT D, PROJ P
 WHERE D.DNO=P.DNO AND D.DNO=V_DEPTNO;
V_TOTAL_FUND NUMBER;
BEGIN
   FOR I IN EMP_PRJ
   LOOP
V_TOTAL_FUND:=I.TOTAL;
RETURN V_TOTAL_FUND;
END LOOP;
END;
/

